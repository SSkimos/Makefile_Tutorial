# Makefile tutorial for School 21 students
 
Эта статься предназначена для тех, кто только поступил в Школу 21
и хочет научиться делать такие Makefile, чтобы было не стыдно и на github их
залить. Наверное, вы думаете, что такой навык вам не понадобится. Возможно, вы правы
я тоже так думал, пока не сел изучать golang.

Данная статья вдохновлена другой статьей, ознакомиться с которой можно по ссылке:
`https://makefiletutorial.com/#makefile-cookbook`

Также, в качестве проекта, на примере которого мы будем создавать
Makefile я выбрал проект с матрицами. 

Повествование будет от простого к сложному. Поэтому, для вашего удобства
есть оглавление:
- типа оглавление

### Прежде чем написать свой Makefile, определимся с тем, что он должен уметь:
- собрать проект как статическую библиотеку
- не только запустить тесты, но и проверить покрытие кода
- проверка кода следующими линтерами:
    + cppcheck
    + valgring
    + leaks
- не забудем про отдельные флаги для санитайзера

## Почему Makefile вообще существует?
Makefile появились на Unix-подобных системах и используются для решения вопроса
о том, какие части большой программы требуется перекомпилировать.
Чаще всего компилируются программы, написанные на C, C++ и golang.

## Процесс сборки
Процесс сборки вашей программы выглядит следующим образом:
сперва компилятор берет файлы с исходным кодом и получает из них объектные файлы.
Затем линковщик берет полученные объектные файлы и получает исполняемый файл.
**TODO: красивая картинка процессов (препроцессинг, компиляция, линковка)**

## Компиляция лапками
Самым простым способом собрать программу, будет компиляция лапкой.
#### `gcc s21_matrix.c matrix_test.c -o test.out; ./test.out`
Конечно, для этого не придется долго разбираться с документацией, читать много 
сайтов и понимать, как эти ваши мейкфайлы работают. Но если файлов будет 10?
20? 100? Каждый раз набирать столько теста не очень удобно, так что мы сейчас
будем это автоматизировать.

## Самый простой Makefile
```
цель: требуемые зависимости
[tab] выполняемая команда
```
Для примера, который мы компилировали ручками, Makefile может выглядеть так:
```
all:
    gcc s21_matrix.c matrix_test.c -o test.out -o test.out
    ./test.out
```
По умолчанию, цель `all` говорит мейкфайлу собрать ее, если никакая
другая цель не указана явно. Так как у цели зависимостей нет, то make сразу
выполнит команду и запустит компилятор.


